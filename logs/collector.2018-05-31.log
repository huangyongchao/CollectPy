2018-05-31 13:41:46 main.py  init_task_conf 32 INFO loading  tasks  file :  ../conf/task.json :
2018-05-31 13:41:46 main.py  init_task_conf 35 INFO [{'taskid': 'test3', 'interval_sec': 10, 'input': {'mysql': {'host': '172.16.18.119', 'port': 3306, 'user': 'yiqifatest', 'passwd': 'yiqifatest', 'db': 'yiqifa_high_goods'}, 'pagesize': '2', 'tracingid': 'id', 'tracingtime': 'update_time', 'tracingid_val': '-1', 'tracingtime_val': '2017-01-01', 'sql': 'select * from  complete_product'}, 'filter': {'time_fmt': {'fields': ['update_time', 'create_time', 'system_update_time', 'start_date', 'end_date'], 'fmt': '%Y-%m-%d %H:%M:%S'}, 'camel_case': True}, 'outputs': [{'type': 'elasticsearch', 'nodes': ['221.122.127.201: 9200', '221.122.127.101: 9200', '221.122.127.68: 9200'], 'auth': 'elastic,changeme', 'index': 'logstash_product', 'doctype': 'doc', 'docid': 'id'}, {'type': 'kafka', 'nodes': ['221.122.127.54:9092', '221.122.127.22:9092', '221.122.127.58:9092'], 'topic': 'testcollect'}, {'type': 'redis', 'nodes': ['221.122.127.103: 14000', '221.122.127.127:14000'], 'datatype': 'string', 'key': 'pd:%s%s', 'keyfields': ['product_id', 'advertiser_name', 'advertiser_id'], 'expiresec': 1000, 'hkey': 'pd:%s', 'hkeyfields': 'pd:%s', 'valuetype': 'json'}]}]
2018-05-31 13:41:46 main.py  start_task 58 INFO tasks started !
2018-05-31 13:41:56 collect_task.py  run 38 INFO test3 params: {'tracing_id': '-1', 'and_id': False, 'tracing_time': '2017-01-01'} 
2018-05-31 13:41:57 base.py  log_request_success 83 INFO POST http://221.122.127.68: 9200/_bulk [status:200 request:0.105s]
2018-05-31 13:41:57 client_async.py  _bootstrap 224 INFO Bootstrapping cluster metadata from [('221.122.127.54', 9092, <AddressFamily.AF_INET: 2>), ('221.122.127.22', 9092, <AddressFamily.AF_INET: 2>), ('221.122.127.58', 9092, <AddressFamily.AF_INET: 2>)]
2018-05-31 13:41:57 conn.py  connect 309 INFO <BrokerConnection node_id=bootstrap host=221.122.127.54/221.122.127.54 port=9092>: connecting to 221.122.127.54:9092
2018-05-31 13:41:57 client_async.py  _bootstrap 263 INFO Bootstrap succeeded: found 3 brokers and 122 topics.
2018-05-31 13:41:57 conn.py  close 628 INFO <BrokerConnection node_id=bootstrap host=221.122.127.54/221.122.127.54 port=9092>: Closing connection. 
2018-05-31 13:41:57 conn.py  connect 309 INFO <BrokerConnection node_id=2 host=221.122.127.58/221.122.127.58 port=9092>: connecting to 221.122.127.58:9092
2018-05-31 13:41:57 conn.py  check_version 1033 INFO Broker is not v(0, 10) -- it did not recognize ApiVersionRequest_v0
2018-05-31 13:41:57 conn.py  check_version 1033 INFO Broker is not v(0, 9) -- it did not recognize ListGroupsRequest_v0
2018-05-31 13:41:57 conn.py  check_version 1033 INFO Broker is not v(0, 8, 2) -- it did not recognize GroupCoordinatorRequest_v0
2018-05-31 13:41:57 conn.py  check_version 1033 INFO Broker is not v(0, 8, 1) -- it did not recognize OffsetFetchRequest_v0
2018-05-31 13:41:58 conn.py  check_version 1006 INFO Broker version identifed as 0.8.0
2018-05-31 13:41:58 conn.py  check_version 1008 INFO Set configuration api_version=(0, 8, 0) to skip auto check_version requests on startup
2018-05-31 13:42:12 kafka.py  close 423 INFO Closing the Kafka producer with 0 secs timeout.
2018-05-31 13:42:12 kafka.py  close 443 INFO Proceeding to force close the producer since pending requests could not be completed within timeout 0.
2018-05-31 13:42:12 conn.py  close 628 INFO <BrokerConnection node_id=2 host=221.122.127.58/221.122.127.58 port=9092>: Closing connection. 
2018-05-31 13:42:33 main.py  init_task_conf 32 INFO loading  tasks  file :  ../conf/task.json :
2018-05-31 13:42:33 main.py  init_task_conf 35 INFO [{'taskid': 'test3', 'interval_sec': 10, 'input': {'mysql': {'host': '172.16.18.119', 'port': 3306, 'user': 'yiqifatest', 'passwd': 'yiqifatest', 'db': 'yiqifa_high_goods'}, 'pagesize': '2', 'tracingid': 'id', 'tracingtime': 'update_time', 'tracingid_val': '-1', 'tracingtime_val': '2017-01-01', 'sql': 'select * from  complete_product'}, 'filter': {'time_fmt': {'fields': ['update_time', 'create_time', 'system_update_time', 'start_date', 'end_date'], 'fmt': '%Y-%m-%d %H:%M:%S'}, 'camel_case': True}, 'outputs': [{'type': 'elasticsearch', 'nodes': ['221.122.127.201: 9200', '221.122.127.101: 9200', '221.122.127.68: 9200'], 'auth': 'elastic,changeme', 'index': 'logstash_product', 'doctype': 'doc', 'docid': 'id'}, {'type': 'kafka', 'nodes': ['221.122.127.54:9092', '221.122.127.22:9092', '221.122.127.58:9092'], 'topic': 'testcollect'}, {'type': 'redis', 'nodes': ['221.122.127.103: 14000', '221.122.127.127:14000'], 'datatype': 'string', 'key': 'pd:%s%s', 'keyfields': ['product_id', 'advertiser_name', 'advertiser_id'], 'expiresec': 1000, 'hkey': 'pd:%s', 'hkeyfields': 'pd:%s', 'valuetype': 'json'}]}]
2018-05-31 13:42:50 main.py  init_task_conf 32 INFO loading  tasks  file :  ../conf/task.json :
2018-05-31 13:42:50 main.py  init_task_conf 35 INFO [{'taskid': 'test3', 'interval_sec': 10, 'input': {'mysql': {'host': '172.16.18.119', 'port': 3306, 'user': 'yiqifatest', 'passwd': 'yiqifatest', 'db': 'yiqifa_high_goods'}, 'pagesize': '2', 'tracingid': 'id', 'tracingtime': 'update_time', 'tracingid_val': '-1', 'tracingtime_val': '2017-01-01', 'sql': 'select * from  complete_product'}, 'filter': {'time_fmt': {'fields': ['update_time', 'create_time', 'system_update_time', 'start_date', 'end_date'], 'fmt': '%Y-%m-%d %H:%M:%S'}, 'camel_case': True}, 'outputs': [{'type': 'elasticsearch', 'nodes': ['221.122.127.201: 9200', '221.122.127.101: 9200', '221.122.127.68: 9200'], 'auth': 'elastic,changeme', 'index': 'logstash_product', 'doctype': 'doc', 'docid': 'id'}, {'type': 'kafka', 'nodes': ['221.122.127.54:9092', '221.122.127.22:9092', '221.122.127.58:9092'], 'topic': 'testcollect'}, {'type': 'redis', 'nodes': ['221.122.127.103: 14000', '221.122.127.127:14000'], 'datatype': 'string', 'key': 'pd:%s%s', 'keyfields': ['product_id', 'advertiser_name', 'advertiser_id'], 'expiresec': 1000, 'hkey': 'pd:%s', 'hkeyfields': 'pd:%s', 'valuetype': 'json'}]}]
2018-05-31 13:43:07 main.py  init_task_conf 32 INFO loading  tasks  file :  ../conf/task.json :
2018-05-31 13:43:07 main.py  init_task_conf 35 INFO [{'taskid': 'test3', 'interval_sec': 10, 'input': {'mysql': {'host': '172.16.18.119', 'port': 3306, 'user': 'yiqifatest', 'passwd': 'yiqifatest', 'db': 'yiqifa_high_goods'}, 'pagesize': '2', 'tracingid': 'id', 'tracingtime': 'update_time', 'tracingid_val': '-1', 'tracingtime_val': '2017-01-01', 'sql': 'select * from  complete_product'}, 'filter': {'time_fmt': {'fields': ['update_time', 'create_time', 'system_update_time', 'start_date', 'end_date'], 'fmt': '%Y-%m-%d %H:%M:%S'}, 'camel_case': True}, 'outputs': [{'type': 'elasticsearch', 'nodes': ['221.122.127.201: 9200', '221.122.127.101: 9200', '221.122.127.68: 9200'], 'auth': 'elastic,changeme', 'index': 'logstash_product', 'doctype': 'doc', 'docid': 'id'}, {'type': 'kafka', 'nodes': ['221.122.127.54:9092', '221.122.127.22:9092', '221.122.127.58:9092'], 'topic': 'testcollect'}, {'type': 'redis', 'nodes': ['221.122.127.103: 14000', '221.122.127.127:14000'], 'datatype': 'string', 'key': 'pd:%s%s', 'keyfields': ['product_id', 'advertiser_name', 'advertiser_id'], 'expiresec': 1000, 'hkey': 'pd:%s', 'hkeyfields': 'pd:%s', 'valuetype': 'json'}]}]
2018-05-31 13:43:09 main.py  init_task_conf 32 INFO loading  tasks  file :  ../conf/task.json :
2018-05-31 13:43:09 main.py  init_task_conf 35 INFO [{'taskid': 'test3', 'interval_sec': 10, 'input': {'mysql': {'host': '172.16.18.119', 'port': 3306, 'user': 'yiqifatest', 'passwd': 'yiqifatest', 'db': 'yiqifa_high_goods'}, 'pagesize': '2', 'tracingid': 'id', 'tracingtime': 'update_time', 'tracingid_val': '-1', 'tracingtime_val': '2017-01-01', 'sql': 'select * from  complete_product'}, 'filter': {'time_fmt': {'fields': ['update_time', 'create_time', 'system_update_time', 'start_date', 'end_date'], 'fmt': '%Y-%m-%d %H:%M:%S'}, 'camel_case': True}, 'outputs': [{'type': 'elasticsearch', 'nodes': ['221.122.127.201: 9200', '221.122.127.101: 9200', '221.122.127.68: 9200'], 'auth': 'elastic,changeme', 'index': 'logstash_product', 'doctype': 'doc', 'docid': 'id'}, {'type': 'kafka', 'nodes': ['221.122.127.54:9092', '221.122.127.22:9092', '221.122.127.58:9092'], 'topic': 'testcollect'}, {'type': 'redis', 'nodes': ['221.122.127.103: 14000', '221.122.127.127:14000'], 'datatype': 'string', 'key': 'pd:%s%s', 'keyfields': ['product_id', 'advertiser_name', 'advertiser_id'], 'expiresec': 1000, 'hkey': 'pd:%s', 'hkeyfields': 'pd:%s', 'valuetype': 'json'}]}]
2018-05-31 13:43:11 collect_task.py  run 38 INFO test3 params: {'tracing_id': 69270, 'and_id': True, 'tracing_time': '2018-01-17 12:01:44'} 
2018-05-31 13:43:12 base.py  log_request_success 83 INFO POST http://221.122.127.101: 9200/_bulk [status:200 request:0.196s]
2018-05-31 13:43:12 client_async.py  _bootstrap 224 INFO Bootstrapping cluster metadata from [('221.122.127.54', 9092, <AddressFamily.AF_INET: 2>), ('221.122.127.58', 9092, <AddressFamily.AF_INET: 2>), ('221.122.127.22', 9092, <AddressFamily.AF_INET: 2>)]
2018-05-31 13:43:12 conn.py  connect 309 INFO <BrokerConnection node_id=bootstrap host=221.122.127.54/221.122.127.54 port=9092>: connecting to 221.122.127.54:9092
2018-05-31 13:43:12 client_async.py  _bootstrap 263 INFO Bootstrap succeeded: found 3 brokers and 122 topics.
2018-05-31 13:43:12 conn.py  close 628 INFO <BrokerConnection node_id=bootstrap host=221.122.127.54/221.122.127.54 port=9092>: Closing connection. 
2018-05-31 13:43:12 conn.py  connect 309 INFO <BrokerConnection node_id=0 host=221.122.127.22/221.122.127.22 port=9092>: connecting to 221.122.127.22:9092
2018-05-31 13:43:12 conn.py  check_version 1033 INFO Broker is not v(0, 10) -- it did not recognize ApiVersionRequest_v0
2018-05-31 13:43:12 conn.py  check_version 1033 INFO Broker is not v(0, 9) -- it did not recognize ListGroupsRequest_v0
2018-05-31 13:43:12 conn.py  check_version 1033 INFO Broker is not v(0, 8, 2) -- it did not recognize GroupCoordinatorRequest_v0
2018-05-31 13:43:13 conn.py  check_version 1033 INFO Broker is not v(0, 8, 1) -- it did not recognize OffsetFetchRequest_v0
2018-05-31 13:43:13 conn.py  check_version 1006 INFO Broker version identifed as 0.8.0
2018-05-31 13:43:13 conn.py  check_version 1008 INFO Set configuration api_version=(0, 8, 0) to skip auto check_version requests on startup
2018-05-31 13:43:13 conn.py  connect 309 INFO <BrokerConnection node_id=2 host=221.122.127.58/221.122.127.58 port=9092>: connecting to 221.122.127.58:9092
2018-05-31 13:43:14 kafka.py  close 423 INFO Closing the Kafka producer with 0 secs timeout.
2018-05-31 13:43:14 kafka.py  close 443 INFO Proceeding to force close the producer since pending requests could not be completed within timeout 0.
2018-05-31 13:43:14 conn.py  close 628 INFO <BrokerConnection node_id=0 host=221.122.127.22/221.122.127.22 port=9092>: Closing connection. 
2018-05-31 13:43:14 conn.py  close 628 INFO <BrokerConnection node_id=2 host=221.122.127.58/221.122.127.58 port=9092>: Closing connection. 
2018-05-31 13:43:31 main.py  init_task_conf 32 INFO loading  tasks  file :  ../conf/task.json :
2018-05-31 13:43:31 main.py  init_task_conf 35 INFO [{'taskid': 'test3', 'interval_sec': 10, 'input': {'mysql': {'host': '172.16.18.119', 'port': 3306, 'user': 'yiqifatest', 'passwd': 'yiqifatest', 'db': 'yiqifa_high_goods'}, 'pagesize': '2', 'tracingid': 'id', 'tracingtime': 'update_time', 'tracingid_val': '-1', 'tracingtime_val': '2017-01-01', 'sql': 'select * from  complete_product'}, 'filter': {'time_fmt': {'fields': ['update_time', 'create_time', 'system_update_time', 'start_date', 'end_date'], 'fmt': '%Y-%m-%d %H:%M:%S'}, 'camel_case': True}, 'outputs': [{'type': 'elasticsearch', 'nodes': ['221.122.127.201: 9200', '221.122.127.101: 9200', '221.122.127.68: 9200'], 'auth': 'elastic,changeme', 'index': 'logstash_product', 'doctype': 'doc', 'docid': 'id'}, {'type': 'kafka', 'nodes': ['221.122.127.54:9092', '221.122.127.22:9092', '221.122.127.58:9092'], 'topic': 'testcollect'}, {'type': 'redis', 'nodes': ['221.122.127.103: 14000', '221.122.127.127:14000'], 'datatype': 'string', 'key': 'pd:%s%s', 'keyfields': ['product_id', 'advertiser_name', 'advertiser_id'], 'expiresec': 1000, 'hkey': 'pd:%s', 'hkeyfields': 'pd:%s', 'valuetype': 'json'}]}]
2018-05-31 13:43:46 collect_task.py  run 38 INFO test3 params: {'tracing_id': 69306, 'and_id': True, 'tracing_time': '2018-01-17 12:01:44'} 
2018-05-31 13:43:49 base.py  log_request_success 83 INFO POST http://221.122.127.201: 9200/_bulk [status:200 request:0.337s]
2018-05-31 13:43:49 client_async.py  _bootstrap 224 INFO Bootstrapping cluster metadata from [('221.122.127.22', 9092, <AddressFamily.AF_INET: 2>), ('221.122.127.58', 9092, <AddressFamily.AF_INET: 2>), ('221.122.127.54', 9092, <AddressFamily.AF_INET: 2>)]
2018-05-31 13:43:49 conn.py  connect 309 INFO <BrokerConnection node_id=bootstrap host=221.122.127.22/221.122.127.22 port=9092>: connecting to 221.122.127.22:9092
2018-05-31 13:43:49 client_async.py  _bootstrap 263 INFO Bootstrap succeeded: found 3 brokers and 122 topics.
2018-05-31 13:43:49 conn.py  close 628 INFO <BrokerConnection node_id=bootstrap host=221.122.127.22/221.122.127.22 port=9092>: Closing connection. 
2018-05-31 13:43:49 conn.py  connect 309 INFO <BrokerConnection node_id=0 host=221.122.127.22/221.122.127.22 port=9092>: connecting to 221.122.127.22:9092
2018-05-31 13:43:50 conn.py  check_version 1033 INFO Broker is not v(0, 10) -- it did not recognize ApiVersionRequest_v0
2018-05-31 13:43:50 conn.py  check_version 1033 INFO Broker is not v(0, 9) -- it did not recognize ListGroupsRequest_v0
2018-05-31 13:43:50 conn.py  check_version 1033 INFO Broker is not v(0, 8, 2) -- it did not recognize GroupCoordinatorRequest_v0
2018-05-31 13:43:51 conn.py  check_version 1033 INFO Broker is not v(0, 8, 1) -- it did not recognize OffsetFetchRequest_v0
2018-05-31 13:43:52 conn.py  check_version 1006 INFO Broker version identifed as 0.8.0
2018-05-31 13:43:52 conn.py  check_version 1008 INFO Set configuration api_version=(0, 8, 0) to skip auto check_version requests on startup
2018-05-31 13:43:52 conn.py  connect 309 INFO <BrokerConnection node_id=1 host=221.122.127.54/221.122.127.54 port=9092>: connecting to 221.122.127.54:9092
2018-05-31 13:43:52 conn.py  connect 309 INFO <BrokerConnection node_id=2 host=221.122.127.58/221.122.127.58 port=9092>: connecting to 221.122.127.58:9092
2018-05-31 13:43:53 kafka.py  close 423 INFO Closing the Kafka producer with 0 secs timeout.
2018-05-31 13:43:53 kafka.py  close 443 INFO Proceeding to force close the producer since pending requests could not be completed within timeout 0.
2018-05-31 13:43:53 conn.py  close 628 INFO <BrokerConnection node_id=0 host=221.122.127.22/221.122.127.22 port=9092>: Closing connection. 
2018-05-31 13:43:53 conn.py  close 628 INFO <BrokerConnection node_id=1 host=221.122.127.54/221.122.127.54 port=9092>: Closing connection. 
2018-05-31 13:43:53 conn.py  close 628 INFO <BrokerConnection node_id=2 host=221.122.127.58/221.122.127.58 port=9092>: Closing connection. 
2018-05-31 13:44:27 main.py  init_task_conf 32 INFO loading  tasks  file :  ../conf/task.json :
2018-05-31 13:44:27 main.py  init_task_conf 35 INFO [{'taskid': 'test3', 'interval_sec': 10, 'input': {'mysql': {'host': '172.16.18.119', 'port': 3306, 'user': 'yiqifatest', 'passwd': 'yiqifatest', 'db': 'yiqifa_high_goods'}, 'pagesize': '2', 'tracingid': 'id', 'tracingtime': 'update_time', 'tracingid_val': '-1', 'tracingtime_val': '2017-01-01', 'sql': 'select * from  complete_product'}, 'filter': {'time_fmt': {'fields': ['update_time', 'create_time', 'system_update_time', 'start_date', 'end_date'], 'fmt': '%Y-%m-%d %H:%M:%S'}, 'camel_case': True}, 'outputs': [{'type': 'elasticsearch', 'nodes': ['221.122.127.201: 9200', '221.122.127.101: 9200', '221.122.127.68: 9200'], 'auth': 'elastic,changeme', 'index': 'logstash_product', 'doctype': 'doc', 'docid': 'id'}, {'type': 'kafka', 'nodes': ['221.122.127.54:9092', '221.122.127.22:9092', '221.122.127.58:9092'], 'topic': 'testcollect'}, {'type': 'redis', 'nodes': ['221.122.127.103: 14000', '221.122.127.127:14000'], 'datatype': 'string', 'key': 'pd:%s%s', 'keyfields': ['product_id', 'advertiser_name', 'advertiser_id'], 'expiresec': 1000, 'hkey': 'pd:%s', 'hkeyfields': 'pd:%s', 'valuetype': 'json'}]}]
